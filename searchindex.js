Search.setIndex({"docnames": ["api_reference/center_selector", "api_reference/gsc_losses", "api_reference/hopt", "api_reference/index", "api_reference/kernels", "api_reference/mmv_ops", "api_reference/models", "api_reference/optimization", "api_reference/options", "api_reference/outofcore", "api_reference/preconditioner", "api_reference/sparse", "examples/custom_kernels", "examples/examples", "examples/falkon_cv", "examples/falkon_mnist", "examples/falkon_regression_tutorial", "examples/hyperopt", "examples/logistic_falkon", "get_started", "index", "install"], "filenames": ["api_reference/center_selector.rst", "api_reference/gsc_losses.rst", "api_reference/hopt.rst", "api_reference/index.rst", "api_reference/kernels.rst", "api_reference/mmv_ops.rst", "api_reference/models.rst", "api_reference/optimization.rst", "api_reference/options.rst", "api_reference/outofcore.rst", "api_reference/preconditioner.rst", "api_reference/sparse.rst", "examples/custom_kernels.ipynb", "examples/examples.rst", "examples/falkon_cv.ipynb", "examples/falkon_mnist.ipynb", "examples/falkon_regression_tutorial.ipynb", "examples/hyperopt.ipynb", "examples/logistic_falkon.ipynb", "get_started.rst", "index.rst", "install.rst"], "titles": ["falkon.center_selection", "falkon.gsc_losses", "falkon.hopt", "API Reference", "falkon.kernels", "falkon.mmv_ops", "falkon.models", "falkon.optim", "falkon.options", "falkon.ooc_ops", "falkon.preconditioner", "falkon.sparse", "Implementing A Custom Kernel", "Examples", "Hyperparameter Tuning with Falkon", "MNIST Classification with Falkon", "Falkon Regression Tutorial", "Automatic Hyperparameter Optimization", "Introducing Logistic Falkon", "Getting Started", "Falkon", "Install"], "terms": {"class": [0, 1, 2, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19], "random_gen": 0, "creat": [0, 4, 6, 10, 14], "center": [0, 1, 6, 7, 8, 10, 15, 17], "selector": 0, "random": [0, 4, 6, 12, 15, 16, 17], "number": [0, 1, 4, 6, 7, 8, 10, 11, 14, 15, 16, 17, 18, 19], "gener": [0, 1, 3, 4, 6, 7, 10, 12, 18, 20], "paramet": [0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], "A": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 20], "numpi": [0, 12, 14, 16, 17, 18, 21], "object": [0, 3, 4, 5, 6, 8, 10, 11, 16, 17, 18], "seed": [0, 6, 17], "abstract": [0, 1, 4, 10], "select": [0, 6, 11], "x": [0, 1, 4, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18, 19], "y": [0, 1, 2, 4, 6, 7, 10, 12, 14, 16, 17, 18, 19], "union": [0, 4, 5, 6, 10, 11], "tensor": [0, 1, 2, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20], "sparsetensor": [0, 3, 4, 5, 10, 12], "tupl": [0, 1, 6, 11], "method": [0, 1, 3, 4, 5, 6, 10, 12, 16, 18, 20], "m": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11, 12, 14, 15, 16, 18, 19], "from": [0, 1, 2, 4, 5, 6, 7, 8, 10, 11, 12, 14, 16, 17, 18, 19, 21], "data": [0, 1, 4, 5, 6, 8, 9, 10, 11, 20], "The": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20], "full": [0, 4, 5, 8, 10, 12, 20], "input": [0, 1, 4, 5, 6, 9, 11, 12], "dataset": [0, 6, 8, 12, 14, 16, 17, 18, 19, 20], "represent": [0, 11, 14, 15, 17], "label": [0, 1, 14, 15, 16, 17, 18], "thi": [0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21], "mai": [0, 1, 4, 5, 6, 8, 12, 14, 18], "none": [0, 1, 2, 4, 5, 6, 7, 9, 10, 11, 12, 16], "return": [0, 1, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18], "x_center": 0, "If": [0, 4, 5, 6, 7, 8, 10, 11, 14, 20, 21], "onli": [0, 1, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 21], "output": [0, 1, 4, 5, 9, 11, 12, 18, 19], "y_center": 0, "empti": [0, 7], "set": [0, 1, 4, 5, 6, 7, 8, 9, 10, 12, 16, 19], "shall": [0, 7], "well": [0, 6], "select_indic": 0, "indic": [0, 4, 6, 11, 12, 14], "associ": [0, 1], "chosen": [0, 4, 15, 17], "subclass": [0, 1, 4], "implement": [0, 1, 4, 5, 6, 7, 9, 10, 13, 18], "which": [0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21], "case": [0, 4, 8, 9, 14, 17, 18, 21], "notimplementederror": [0, 5, 12], "rais": [0, 8, 12], "num_cent": 0, "int": [0, 2, 5, 6, 7, 8, 10, 11, 12, 16], "base": [0, 4, 6, 7, 8, 10, 12, 13, 17, 18], "choos": [0, 4, 6, 17], "uniformli": [0, 15, 17], "without": [0, 4, 12], "replac": [0, 17], "should": [0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 18, 21], "option": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20], "observ": [0, 17], "2d": [0, 9, 10, 11, 18], "preserv": [0, 9], "devic": [0, 5, 8, 11, 12], "memori": [0, 4, 5, 8, 9, 20], "order": [0, 4, 6, 10], "strategi": 0, "To": [0, 4, 6, 9, 12, 16, 21], "control": [0, 8], "pass": [0, 1, 4, 6, 7, 10, 14, 16, 18, 20], "an": [0, 1, 4, 6, 7, 8, 10, 11, 12, 18, 20], "appropri": [0, 4, 10, 12], "s": [0, 2, 6, 14, 17, 18, 20], "constructor": [0, 4, 6, 7, 12], "n": [0, 1, 2, 4, 5, 6, 7, 9, 10, 11, 12], "d": [0, 1, 4, 5, 8, 10, 11, 12, 14, 17], "contain": [0, 1, 6, 7, 9, 10, 11, 12, 14, 16, 18], "whole": [0, 4, 10, 15, 17], "lower": [0, 6, 8, 9, 10, 17, 18, 20], "than": [0, 1, 4, 6, 8, 10, 14, 18], "program": 0, "pick": [0, 6, 12], "warn": [0, 8, 12, 14, 15, 16, 17, 18], "t": [0, 1, 4, 5, 7, 9, 10, 12], "target": [0, 6, 10], "provid": [0, 1, 4, 5, 6, 7, 9, 14, 15], "same": [0, 1, 2, 4, 5, 6, 9, 10, 11, 14, 17, 18], "also": [0, 1, 4, 12, 14, 18, 20], "certain": [0, 6, 15, 21], "model": [0, 1, 3, 8, 10, 12, 17, 19, 20], "logisticfalkon": [0, 1, 3, 10, 14, 18, 19], "requir": [0, 2, 4, 5, 10, 12, 19, 21], "extract": 0, "both": [0, 4, 6, 7, 10, 12, 14, 16, 19, 20, 21], "predictor": 0, "while": [0, 4, 9, 10, 14, 16, 18, 21], "other": [0, 1, 4, 8, 9, 10, 12, 18, 20], "x_m": 0, "randomli": [0, 4, 6], "thei": [0, 4, 5, 6, 8, 9, 12, 17, 18], "new": [0, 4, 5, 9, 11, 16], "contigu": [0, 6, 9, 11], "all": [0, 4, 6, 8, 11, 12, 13, 17, 19, 20], "characterist": [0, 8], "y_m": 0, "wa": [0, 5, 6, 14], "differ": [0, 1, 4, 5, 6, 7, 8, 10, 12, 14, 17, 18, 19], "entri": 0, "correspond": [0, 4, 6, 10, 11, 15, 17], "behav": 0, "addition": [0, 1], "longtensor": 0, "point": [0, 4, 6, 8, 10, 12, 14, 16, 17, 18, 20], "store": [0, 4, 5, 8, 10, 12], "idx_cent": 0, "alwai": [0, 8, 9, 14, 17, 18], "fix": 0, "ar": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21], "specifi": [0, 4, 5, 6, 8, 12, 18], "initi": [0, 4, 6, 7, 10, 12, 14, 15, 16, 17], "time": [0, 1, 5, 7, 8, 9, 10, 12, 14, 15, 18, 21], "us": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "call": [0, 4, 6, 7, 10, 12], "non": [0, 4, 11, 15], "argument": [0, 1, 4, 6, 7, 12], "throw": 0, "except": 0, "given": [0, 1, 4, 10, 12, 14, 16], "instanc": [0, 1, 4, 6, 12, 18], "ignor": [0, 4], "ones": [0, 7, 8, 9, 17], "valu": [0, 1, 4, 6, 8, 10, 11, 12, 14, 15, 16, 17, 18], "runtimeerror": 0, "name": [1, 2, 4, 6, 12], "str": [1, 4, 5, 6, 8, 11], "kernel": [1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 16, 17, 18, 19, 20, 21], "opt": [1, 4, 5, 7, 9, 10, 12, 16, 17, 18], "falkonopt": [1, 2, 3, 4, 5, 6, 7, 9, 10, 12, 14, 15, 16, 17, 18, 19], "self": [1, 4, 6, 12, 18, 20], "concord": [1, 6, 18, 20], "function": [1, 3, 4, 6, 7, 9, 10, 11, 12, 16, 17, 18], "Such": [1, 8], "must": [1, 2, 4, 5, 6, 7, 8, 10, 11, 12, 14, 16, 17], "three": [1, 4, 5, 6, 8, 11, 17, 18], "differenti": [1, 4, 5, 8], "algorithm": [1, 5, 6, 7, 8, 9, 10, 15, 16, 17, 18, 20], "first": [1, 2, 4, 5, 6, 10, 11, 12, 14, 16, 17], "two": [1, 2, 4, 5, 6, 9, 10, 12, 14, 16, 18, 20], "deriv": [1, 4, 10], "__call__": [1, 4], "calcul": [1, 2, 4, 5, 6, 8, 9, 20], "vector": [1, 2, 4, 5, 6, 7, 8, 10, 12, 14, 17], "could": [1, 2, 7, 9, 14, 16], "matric": [1, 2, 4, 5, 7, 8, 10, 11, 12], "e": [1, 4, 6, 8, 10, 11, 14, 17, 18, 21], "g": [1, 4, 6, 8, 10, 11, 14, 17], "softmax": 1, "df": [1, 14], "ddf": 1, "second": [1, 4, 10, 14], "knmp_grad": 1, "knmp_hess": 1, "product": [1, 3, 5, 8, 10, 12], "These": [1, 12, 17], "specif": [1, 18], "descript": 1, "train": [1, 6, 7, 8, 12, 15], "logfalkon": 1, "Will": [1, 5, 11], "when": [1, 4, 6, 8, 9, 12, 14, 16, 17], "comput": [1, 3, 4, 5, 6, 7, 8, 10, 11, 12, 15, 16, 20], "logisticloss": [1, 6, 10, 18], "concret": [1, 4, 10], "gsc": 1, "y1": 1, "y2": 1, "predict": [1, 6, 12, 14, 15, 16, 17, 19], "true": [1, 4, 5, 6, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19], "torch": [1, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 21], "One": [1, 3], "interpret": [1, 4, 11], "wrt": 1, "respect": [1, 4, 7, 10, 12, 14, 17, 18], "It": [1, 2, 4, 8, 11, 12, 15, 16], "shape": [1, 4, 6, 11, 12, 14, 15, 16, 17], "xc": 1, "u": [1, 9], "where": [1, 2, 4, 5, 6, 7, 10, 16, 18], "k": [1, 2, 4, 5, 12], "repres": [1, 6, 11], "mathcal": 1, "l": [1, 9], "sampl": [1, 4, 6, 12, 14, 17, 18], "follow": [1, 4, 5, 6, 9, 14, 18, 20, 21], "equat": [1, 10], "dfrac": [1, 2, 4], "1": [1, 2, 4, 5, 6, 7, 10, 12, 14, 15, 16, 17, 18, 19, 20], "x_c": 1, "matrix": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 21], "dimens": [1, 4, 8, 10, 12, 16, 17, 18], "depend": [1, 4, 6, 8, 15, 21], "have": [1, 2, 4, 6, 7, 8, 10, 12, 16, 17, 18, 19, 20], "more": [1, 4, 6, 8, 9, 10, 12, 15, 16, 17, 18, 20, 21], "one": [1, 4, 6, 9, 10, 12, 14, 15, 17, 20], "multi": [1, 8, 13, 14, 15, 20], "dimension": [1, 4, 8], "produc": 1, "mmv": [1, 4, 5, 7, 12], "take": [1, 4, 8, 11, 12, 18, 21], "preced": 1, "over": [1, 14, 17], "build": [1, 21], "grad_mul": 1, "come": 1, "multipl": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12], "formula": [1, 4, 5, 12, 18], "func_val": 1, "obtain": [1, 10, 14, 16, 17, 18], "f": [1, 2, 17], "rescal": 1, "typic": [1, 6, 8, 10], "wrapper": [1, 5, 11], "conjunct": 1, "estim": [1, 6, 8, 10, 13, 14, 18, 19, 20], "usag": [1, 4, 5, 8, 9, 20], "assum": [1, 11], "classif": [1, 6, 8, 13, 14, 17, 18, 20], "problem": [1, 2, 6, 8, 10, 13, 14, 16, 17, 18, 20, 21], "For": [1, 2, 4, 6, 8, 9, 10, 12, 14, 18, 19, 20, 21], "choic": [1, 15, 17], "see": [1, 4, 6, 11, 12, 14, 18, 19], "weightedcrossentropyloss": 1, "exampl": [1, 4, 6, 8, 9, 10, 11, 12, 15, 20], "gaussiankernel": [1, 4, 6, 14, 15, 16, 17, 18, 19], "3": [1, 4, 6, 12, 14, 15, 16, 17, 18, 20], "log_loss": 1, "1e": [1, 6, 8, 12, 14, 15, 16, 17, 18, 19], "4": [1, 4, 6, 12, 14, 15, 16, 17, 18], "100": [1, 4, 14, 15, 17, 18, 19], "between": [1, 4, 6, 8, 10, 12, 16, 18], "log": [1, 18], "exp": [1, 4], "y_1": [1, 18], "y_2": [1, 18], "1d": [1, 11], "2": [1, 2, 4, 6, 8, 12, 14, 15, 16, 17, 18, 20], "dd_loss": 1, "d_loss": 1, "neg_weight": 1, "float": [1, 2, 4, 6, 7, 8, 10, 12], "0": [1, 4, 6, 8, 10, 11, 12, 14, 15, 16, 17, 18, 19], "allow": [1, 4, 5, 7, 8, 10, 15, 17], "place": [1, 4, 6, 12], "belong": [1, 4], "assign": 1, "neg": [1, 6], "By": [1, 15, 18], "equal": [1, 4, 12], "equival": [1, 4, 10, 11, 12], "wce_loss": 1, "pred": [1, 6, 12, 14, 16, 17, 18], "bce": 1, "mathrm": [1, 2, 4, 10], "w": [1, 4, 5, 10, 12], "logit": 1, "so": [1, 2, 4, 6, 8, 10, 18, 19, 21], "need": [1, 2, 4, 5, 6, 7, 8, 10, 12, 15, 18, 21], "scale": [1, 4, 6, 12, 13, 14, 15, 17, 20], "befor": [1, 8, 10, 16], "hand": [1, 7, 8, 10, 15], "hyperoptobject": 2, "diffkernel": [2, 3, 12], "centers_init": [2, 17], "penalty_init": [2, 17], "opt_cent": [2, 17], "bool": [2, 4, 5, 6, 8, 9, 12], "opt_penalti": [2, 17], "centers_transform": 2, "transform": [2, 15, 16], "pen_transform": 2, "nystromcompreg": [2, 17], "stochasticnystromcompreg": 2, "flk_opt": [2, 12, 17, 18], "flk_maxit": 2, "10": [2, 6, 8, 12, 14, 15, 16, 17, 18, 19], "num_trace_est": 2, "20": [2, 6, 12, 14, 16, 17, 18], "compreg": 2, "gcv": 2, "lvert": [2, 4], "i": [2, 4, 6, 7, 10, 15, 18, 21], "widetild": [2, 7], "_": [2, 14, 15, 18], "lambda": [2, 7, 10, 14, 17], "rvert": [2, 4], "frac": [2, 4, 10], "tr": 2, "we": [2, 4, 6, 7, 8, 10, 11, 12, 14, 15, 16, 17, 18, 20], "term": [2, 17], "denot": 2, "numer": 2, "denomin": 2, "usual": [2, 6, 10, 14, 21], "variabl": [2, 4, 7, 12], "substitut": [2, 4], "taken": [2, 4, 7], "gpflow": 2, "code": [2, 9, 10, 12, 19, 20], "can": [2, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21], "top": [2, 4, 5, 7, 10, 12, 20], "lb": 2, "insid": 2, "norm": [2, 4, 11], "right": [2, 4, 5, 7, 8, 10], "left": [2, 4, 5], "triangular": [2, 7, 9, 10], "solv": [2, 6, 7, 10], "final": [2, 6, 8, 16, 17, 18], "far": [2, 4], "less": [2, 4, 8], "effici": [2, 4, 6, 11, 20], "sinc": [2, 4, 8, 9, 10, 11, 14, 16, 17, 18, 21], "work": [2, 4, 6, 8, 9, 10, 12, 13, 18, 21], "express": 2, "abov": [2, 6], "big": 2, "rvert_f": 2, "holdout": 2, "val_pct": 2, "per_iter_split": 2, "loocv": 2, "minim": [2, 15, 18], "press": 2, "error": [2, 4, 6, 8, 12, 14, 15, 16, 17, 18], "min": [2, 14, 16], "sum_": 2, "e_": 2, "_i": 2, "whose": 2, "compon": [2, 6], "y_i": 2, "alpha_": [2, 6], "alpha": [2, 4, 7, 10, 16, 18], "s_": 2, "ii": 2, "k_": [2, 7, 10], "nm": [2, 4, 7], "mm": [2, 4, 5, 7, 10], "krr": [2, 6, 10], "solut": [2, 4, 7, 10], "diagon": [2, 4, 8, 10, 12], "simplic": 2, "direct": 2, "solver": [2, 6, 7, 20], "although": 2, "easili": [2, 21], "falkon": [3, 12, 13, 17, 19, 21], "incorefalkon": 3, "keopskernelmixin": [3, 12], "radial": 3, "gaussian": [3, 14, 17, 18], "laplacian": 3, "matern": 3, "dot": [3, 12], "polynomi": 3, "linear": [3, 7, 10, 12, 16], "sigmoid": 3, "gsc_loss": [3, 6, 10, 18, 20], "loss": [3, 6, 10, 14, 17, 18, 20], "logist": [3, 6, 10, 13, 20], "weight": [3, 6, 10], "binari": [3, 6, 18, 20], "cross": [3, 13, 14], "entropi": 3, "precondition": [3, 6, 7, 8, 16, 18, 20], "choleski": [3, 8, 9], "falkonprecondition": [3, 7], "logisticprecondition": 3, "optim": [3, 4, 6, 8, 10, 12, 13, 16, 20], "conjug": [3, 6, 8, 10, 16, 18, 19], "gradient": [3, 5, 6, 8, 10, 12, 13, 16, 17, 18, 19], "conjugategradi": 3, "falkonconjugategradi": 3, "ooc_op": [3, 20], "gpu_choleski": 3, "gpu_lauum": 3, "mmv_op": [3, 4, 20], "run_keops_mmv": 3, "fmm": [3, 4], "fmmv": [3, 4], "fdmmv": 3, "incore_fmmv": 3, "incore_fdmmv": 3, "low": [3, 12, 14], "level": [3, 9], "spars": [3, 4, 5, 20, 21], "oper": [3, 4, 5, 9, 10, 12, 21], "center_select": [3, 6, 16, 18, 20], "centerselector": [3, 6], "uniformselector": [3, 16, 18], "fixedselector": 3, "hopt": [3, 4, 12, 13, 17, 20], "nystrom": [3, 6, 7, 8, 10, 17], "complex": [3, 17], "regular": [3, 6, 10, 14, 15, 16, 17, 18], "stochast": [3, 8], "valid": [3, 6, 8, 13, 14, 16, 18], "hold": [3, 4, 11], "out": [3, 4, 5, 8, 9, 11, 12, 13, 14, 20], "leav": 3, "sgpr": 3, "inherit": [4, 12], "overrid": [4, 8, 10], "extend": [4, 18], "you": [4, 6, 8, 12, 13, 16, 20, 21], "read": [4, 20], "document": [4, 6, 8, 12, 20, 21], "carefulli": 4, "look": [4, 7, 12, 19, 20], "exist": [4, 12, 19], "linearkernel": 4, "walk": [4, 13], "through": [4, 6, 7, 12, 13, 19, 20], "custom": [4, 13], "avail": [4, 8, 10, 12, 16, 17], "notebook": [4, 12, 13, 16, 17, 18, 19, 20, 21], "There": [4, 12, 15], "sever": [4, 12, 17, 21], "kind": [4, 17], "support": [4, 5, 7, 10, 11, 14, 16, 18, 20], "concern": 4, "compute_spars": [4, 5, 12], "short": [4, 6, 18], "involv": [4, 8], "x1": [4, 5, 12], "x2": [4, 5, 12], "diag": [4, 5, 12], "fals": [4, 5, 8, 9, 10, 14, 15, 16, 17, 18], "Of": [4, 14], "symmetr": 4, "whether": [4, 5, 8, 9, 11, 15, 17], "just": 4, "size": [4, 5, 8, 9, 10, 11, 12, 17], "cuda": [4, 6, 8, 9, 11, 12, 14, 15, 16, 17, 18], "_decide_dmmv_impl": 4, "v": [4, 5, 10, 12], "dmmv": [4, 5, 12], "note": [4, 6, 7, 8, 9, 10, 11, 12, 18], "doubl": [4, 5, 8, 12], "explan": 4, "what": 4, "multiplicatoin": 4, "forc": [4, 8, 10], "gpu": [4, 5, 6, 8, 9, 10, 13, 15, 16, 20, 21], "cpu": [4, 5, 6, 8, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21], "dmmv_fn": 4, "perform": [4, 6, 7, 8, 10, 18], "decid": [4, 15], "detect": [4, 8, 12, 14, 15, 16, 17, 18], "otherwis": [4, 5, 8, 9, 12], "simpli": [4, 10], "basic": [4, 13, 16, 18, 19], "_decide_mm_impl": 4, "itself": [4, 7, 10, 12], "keop": [4, 5, 8, 18, 19, 20], "mm_fn": 4, "_decide_mmv_impl": 4, "mmv_fn": 4, "regard": [4, 8], "ensur": [4, 14], "correct": [4, 18], "allocat": 4, "underli": [4, 5], "storag": [4, 5, 11], "kwarg": [4, 12], "dens": [4, 5, 11, 12], "addit": [4, 6, 10, 12, 14, 16, 18], "keyword": [4, 12], "some": [4, 5, 10, 11, 16, 17, 18, 21], "might": 4, "current": [4, 5, 7, 10, 11, 20], "sparse_mmv_run_thread": [4, 5], "sparse_mm_run_thread": [4, 5], "x1_csr": 4, "csr": [4, 11, 12], "format": [4, 11, 12], "x2_csr": 4, "form": [4, 6, 7, 10], "remov": [4, 8], "factor": [4, 9], "At": 4, "least": [4, 6, 10], "veri": [4, 7, 16, 18], "larg": [4, 6, 8, 13, 20], "much": [4, 16, 17, 21], "slower": [4, 8, 18], "import": [4, 6, 8, 12, 14, 15, 16, 17, 18, 19, 21], "sigma": [4, 12, 14, 15, 16, 17, 18, 19], "ani": [4, 7, 10, 11, 18], "randn": [4, 6, 12], "150": 4, "extra_mem": 4, "dict": [4, 6], "amount": [4, 6, 8, 10, 15, 16, 17, 18, 19], "extra": [4, 6, 10], "often": [4, 8, 16, 17, 18], "alloc": [4, 5, 9], "avoid": [4, 6, 9, 16, 19], "too": [4, 10, 14], "block": [4, 5, 9], "lead": [4, 6, 14, 18], "oom": 4, "declar": 4, "your": [4, 8, 12, 20], "here": [4, 10, 12, 14, 16, 17, 18], "coeffici": 4, "re": 4, "dictionari": [4, 10], "nd": 4, "possibl": [4, 6, 11, 12, 17, 18], "pairwis": 4, "combin": 4, "md": 4, "make": [4, 6, 10, 12, 18, 20, 21], "sure": [4, 12, 20, 21], "kei": 4, "written": [4, 9], "recogn": 4, "extra_alloc": 4, "string": [4, 8], "how": [4, 6, 8, 9, 10, 12, 13, 14, 18], "mani": [4, 6, 12, 16], "diff_kernel": 4, "core_fn": [4, 12], "kernel_param": 4, "instead": [4, 5, 6, 11, 17, 18], "whenev": [4, 6, 8, 10, 11], "design": [4, 6, 7], "automat": [4, 12], "hyperparamet": [4, 8, 12, 13], "modul": [4, 5, 12, 13, 16, 17, 20], "detach": [4, 12, 17], "its": [4, 8, 10, 12, 18], "graph": [4, 12], "compute_diff": [4, 12], "overridden": [4, 10, 14], "unless": 4, "length": [4, 6, 11, 14, 15, 17], "regist": 4, "even": [4, 8, 14, 17], "signatur": 4, "kernel_paramet": 4, "flag": [4, 8, 12], "includ": [4, 12, 16, 20], "actual": [4, 5, 10], "copi": [4, 6, 11], "diff_param": 4, "construct": 4, "share": [4, 9, 10, 11, 21], "properti": [4, 16], "map": [4, 6, 10, 12], "param": [4, 6, 12, 14], "keops_help": 4, "enabl": [4, 12], "acceler": [4, 8, 10, 20], "keops_mmv_impl": [4, 12], "defin": [4, 9, 10, 11, 17], "helper": 4, "keops_mmv": [4, 12], "help": [4, 5, 8, 10, 17], "check": [4, 8, 9, 12, 16, 20, 21], "alias": [4, 5, 12], "list": [4, 5, 6, 12], "other_var": [4, 5, 12], "referenc": 4, "multipli": [4, 5, 7, 12], "relat": [4, 16], "most": [4, 15, 16, 17], "common": [4, 11, 12, 15], "effect": [4, 9, 10], "embed": 4, "infinit": 4, "govern": [4, 18], "singl": [4, 6, 7, 8, 17, 18], "determin": [4, 6, 8, 14, 15, 18], "width": 4, "distribut": [4, 14, 16, 17, 21], "each": [4, 6, 7, 8, 14, 17, 18], "larger": [4, 6, 8, 14, 16, 17], "wide": [4, 18], "rel": 4, "influenc": [4, 15], "awai": 4, "high": [4, 12, 14, 17], "datum": 4, "On": [4, 18], "opposit": [4, 9], "side": [4, 7, 8, 9, 10], "spectrum": 4, "small": [4, 8, 12, 14, 16, 17, 18], "mean": [4, 8, 12, 14, 15, 16, 17, 18], "nearbi": 4, "scalar": 4, "standard": [4, 14, 15, 16, 17], "deviat": [4, 14, 16, 17], "precis": [4, 8], "invers": [4, 10], "covari": 4, "forward": [4, 9], "routin": 4, "keops_act": [4, 8, 16, 18, 19], "per": [4, 8], "5": [4, 6, 8, 12, 14, 15, 16, 17, 18], "7": [4, 8, 12, 14, 15, 16, 17, 18], "mat": [4, 5], "dtype": [4, 5, 12, 14, 15, 16, 17, 18], "float64": [4, 8, 10, 14, 16, 18], "sym_mat": 4, "0909": 4, "0253": 4, "2490": 4, "3399": 4, "5158": 4, "4922": 4, "rbf": 4, "In": [4, 6, 12, 14, 17, 18, 21], "path": [4, 6, 18], "expand": 4, "laplaciankernel": 4, "similar": [4, 6, 12, 16], "sensit": 4, "chang": [4, 8, 16, 18], "maternkernel": 4, "nu": 4, "parametr": 4, "inf": [4, 8, 16, 18], "close": [4, 8, 14, 16, 17], "infin": 4, "either": [4, 6, 10, 11], "directli": 4, "computation": 4, "polynomialkernel": 4, "beta": [4, 7, 10], "gamma": 4, "degre": 4, "constant": 4, "x_1": [4, 5], "x_2": [4, 5], "apart": 4, "element": [4, 11], "wise": [4, 5, 11], "like": [4, 5, 19, 21], "power": 4, "downstream": 4, "translat": 4, "origin": [4, 9, 11], "space": [4, 6, 17], "default": [4, 6, 8, 15, 17, 18], "squar": [4, 6, 10, 11, 14, 15, 17, 18], "kernel_matrix": 4, "test": [4, 6, 15, 16, 20], "assert_allclos": 4, "sigmoidkernel": 4, "hyperbol": 4, "tangent": 4, "tanh": 4, "blockwis": 5, "agnost": 5, "refer": [5, 6, 8, 16], "thin": 5, "split": [5, 8, 16], "axi": 5, "reduct": 5, "sum": [5, 11, 12, 18], "baseopt": 5, "ad": [5, 8, 18], "respons": [5, 7, 12], "intend": 5, "result": [5, 6, 7, 9, 12, 13, 17], "fmmv_incor": 5, "vec": 5, "transpos": [5, 10, 12], "special": [5, 12], "type": [5, 8, 11, 12, 14, 17, 18], "m1": [5, 12], "m2": [5, 12], "comp_dt": 5, "dev": 5, "tid": 5, "inner": [5, 6, 18], "loop": 5, "part": [5, 9, 10, 12, 15, 16, 18, 20], "ai": 5, "run": [5, 6, 8, 12, 14, 16, 18, 21], "thread": 5, "id": 5, "main": [5, 16, 17, 20], "blk_n": 5, "blk_m": 5, "mem_need": 5, "exit": 5, "pre": 5, "penalti": [6, 10, 12, 14, 15, 16, 17, 18, 19], "uniform": 6, "maxit": [6, 14, 15, 19], "error_fn": [6, 12, 15, 18], "callabl": [6, 7], "error_everi": [6, 12, 15, 18], "weight_fn": [6, 7], "ridg": [6, 13, 20, 21], "regress": [6, 13, 20, 21], "approxim": [6, 7, 10, 16, 20], "nystroem": [6, 8, 10, 16], "project": 6, "fast": [6, 14, 16, 20], "describ": [6, 8], "multiclass": 6, "tackl": 6, "encod": 6, "hot": [6, 14, 15, 17], "appli": [6, 8, 10, 11, 14], "greater": [6, 10], "posit": [6, 9, 10, 14, 16], "total": [6, 7, 14, 18], "better": [6, 8, 14, 17, 18, 20], "accuraci": [6, 14, 18, 20], "resourc": 6, "probabl": 6, "iter": [6, 7, 8, 12, 15, 16, 17, 18, 19], "fewer": 6, "necessari": [6, 12, 16, 18], "howev": [6, 9, 12, 16, 17, 18], "stabl": 6, "across": 6, "present": [6, 10], "incur": 6, "displai": 6, "evolut": 6, "dure": 6, "evalu": [6, 8, 17, 20], "everi": [6, 8, 18], "never": 6, "give": [6, 10, 11], "accept": [6, 7, 18], "As": [6, 14, 17], "individu": 6, "1000": [6, 12, 14, 15, 17, 18], "use_cpu": [6, 8, 10, 12, 14, 15, 16, 17, 18], "6": [6, 12, 14, 15, 16, 17, 18, 19], "500": [6, 14, 17], "fit": [6, 8, 12, 14, 15, 16, 18, 19], "warm": 6, "restart": 6, "warm_start": 6, "beta_": 6, "alessandro": [6, 20], "rudi": [6, 20], "luigi": [6, 20], "carratino": [6, 20], "lorenzo": [6, 20], "rosasco": [6, 20], "advanc": [6, 20], "neural": [6, 20], "inform": [6, 8, 10, 19, 20], "process": [6, 17, 18, 20], "system": [6, 7, 10, 20], "29": [6, 12, 17], "2017": [6, 20], "giacomo": [6, 16, 20], "meanti": [6, 20], "roof": [6, 20], "handl": [6, 20], "billion": [6, 20], "2020": [6, 20], "xt": 6, "yt": 6, "num_sampl": 6, "num_dimens": 6, "fortran": [6, 9], "column": [6, 11, 14], "num_output": 6, "num_test_sampl": 6, "print": [6, 8, 10, 12, 14, 15, 16, 17, 18], "start": [6, 10, 11, 13, 17, 20], "fill": [6, 9], "zero": [6, 7, 8, 9, 11, 16, 18], "Be": 6, "awar": 6, "previou": 6, "field": 6, "get_param": 6, "deep": 6, "get": [6, 7, 10, 14, 20], "subobject": 6, "learn": [6, 12, 14, 16, 17, 18, 20], "set_param": 6, "simpl": [6, 13, 16, 17], "nest": 6, "pipelin": 6, "latter": 6, "__": 6, "updat": 6, "penalty_list": [6, 18], "iter_list": [6, 18], "repeat": 6, "applic": [6, 18], "decreas": [6, 18], "therefor": [6, 14, 17], "slightli": [6, 12, 18], "cg": [6, 7], "guidanc": 6, "below": [6, 12], "ident": 6, "8": [6, 12, 14, 15, 16, 17, 18], "ulyss": [6, 20], "marteau": [6, 20], "ferei": [6, 20], "franci": [6, 20], "bach": [6, 20], "global": [6, 8, 14, 17, 20], "converg": [6, 7, 8, 15, 16, 20], "newton": [6, 18, 20], "ill": [6, 20], "condit": [6, 10, 20], "neurip": 6, "32": [6, 17], "2019": [6, 20], "rule": 6, "thumb": 6, "keep": [6, 20], "mind": 6, "desir": [6, 18, 21], "around": [6, 8, 14, 18], "down": 6, "step": [6, 10, 16, 17, 18], "Then": [6, 10], "achiev": [6, 7, 18, 21], "good": [6, 14, 17, 18], "attribut": [6, 12, 16, 17], "reason": [6, 10], "switch": [6, 12, 14, 15, 16, 17, 18], "higher": [6, 8, 9, 15, 17, 18], "remain": [6, 14, 16, 17, 18], "core": [6, 8, 9, 12], "compar": [6, 13, 17, 18], "fulli": [6, 12, 13], "within": [6, 12], "constrain": 6, "ha": [6, 12, 14, 17], "smaller": [6, 14], "particular": [6, 7, 17], "constraint": 6, "etc": [6, 16], "centerselctor": 6, "assert": [6, 21], "is_cuda": 6, "shell": 7, "moment": [7, 18], "conjugategradientopt": 7, "x0": 7, "b": [7, 10, 11, 12, 18], "max_it": 7, "callback": 7, "precondit": [7, 16], "via": [7, 10, 13, 14, 21], "ax": [7, 10, 14, 15, 16, 17, 18], "knowledg": 7, "temporari": 7, "incorpor": 7, "user": [7, 14, 18], "maximum": [7, 8, 19], "earli": [7, 18], "stop": [7, 8, 18], "cg_toler": [7, 8, 16, 18], "e_train": 7, "end": [7, 9], "elaps": [7, 12, 15, 18], "begin": [7, 9], "explicitli": 7, "exclud": 7, "h": [7, 10], "sqrt": [7, 12, 16], "sketch": 7, "alreadi": [7, 12], "been": 7, "slowli": [7, 12], "keops_acc_dtyp": [8, 16, 18], "auto": [8, 16, 18], "keops_sum_schem": [8, 16, 18], "keops_memory_slack": [8, 16, 18], "chol_force_in_cor": [8, 16, 18], "chol_force_ooc": [8, 16, 18], "chol_par_blk_multipli": [8, 16, 18], "pc_epsilon_32": [8, 16, 18], "05": [8, 16, 17, 18], "pc_epsilon_64": [8, 16, 18], "13": [8, 12, 14, 15, 16, 17, 18], "cpu_precondition": [8, 10, 16, 18], "cg_epsilon_32": [8, 16, 18], "07": [8, 12, 14, 16, 17, 18], "cg_epsilon_64": [8, 16, 18], "15": [8, 12, 14, 15, 16, 17, 18], "cg_full_gradient_everi": [8, 16, 18], "cg_differential_converg": [8, 16, 18], "debug": [8, 10, 16, 18, 19], "max_gpu_mem": [8, 16, 18], "max_cpu_mem": [8, 16, 18], "compute_arch_spe": [8, 16, 18], "no_single_kernel": [8, 16, 18], "min_cuda_pc_size_32": [8, 16, 18], "10000": [8, 16, 18], "min_cuda_pc_size_64": [8, 16, 18], "30000": [8, 16, 18], "min_cuda_iter_size_32": [8, 16, 18], "300000000": [8, 16, 18], "min_cuda_iter_size_64": [8, 16, 18], "900000000": [8, 16, 18], "never_store_kernel": [8, 16, 18], "store_kernel_d_threshold": [8, 16, 18], "1200": [8, 16, 18], "num_fmm_stream": [8, 16, 18], "extens": [8, 21], "want": [8, 10, 12, 14], "dig": 8, "deeper": 8, "issu": 8, "byte": 8, "ram": 8, "strict": 8, "bound": 8, "due": [8, 12], "natur": [8, 14, 16, 17], "manag": [8, 11], "python": [8, 9, 20], "machin": 8, "rang": [8, 14, 15, 16, 17], "subdivid": 8, "workload": 8, "startup": 8, "faster": [8, 12], "receiv": 8, "do": [8, 12], "increas": [8, 18, 19], "try": [8, 21], "float32": [8, 10, 12, 14, 15, 16, 17, 18], "along": 8, "cutoff": 8, "worth": 8, "experi": [8, 13], "exact": 8, "hardwar": 8, "300_000_000": 8, "measur": [8, 17], "threshold": 8, "10k": 8, "3k": 8, "caus": 8, "900_000_000": 8, "30k": 8, "suffici": 8, "would": 8, "enough": [8, 12], "k_nm": 8, "recomput": [8, 18], "minimum": [8, 16], "consid": [8, 17], "knm": 8, "decis": 8, "greatli": 8, "reduc": [8, 14, 17], "infer": [8, 17], "especi": [8, 17], "costli": 8, "stream": 8, "5000": [8, 16], "accumul": 8, "scheme": [8, 18], "instal": [8, 16, 19, 20], "correctli": [8, 12, 21], "nor": 8, "slack": 8, "hard": [8, 18], "occur": [8, 16, 18], "epsilon": 8, "prevent": [8, 17], "divid": 8, "roughli": 8, "twice": 8, "normal": [8, 10, 12, 13, 14, 16, 17], "reset": [8, 10], "introduc": [8, 16], "procedur": [8, 17], "relev": [8, 9, 10], "criterion": 8, "met": 8, "domin": 8, "decomposit": [8, 9, 10], "execut": 8, "bigger": 8, "parallel": [8, 9], "potrf": [8, 9], "tile": 8, "lauum": 9, "crucial": 9, "speed": [9, 17, 18, 20, 21], "up": [9, 11, 12, 17, 21], "our": [9, 10, 12, 14, 16, 20], "librari": [9, 13, 16, 18, 19, 20, 21], "find": [9, 14, 17, 20], "about": [9, 13, 18, 20], "sourc": [9, 20], "interfac": [9, 16], "upper": [9, 10], "clean": 9, "overwrit": 9, "definit": [9, 10, 12], "triangl": [9, 10], "doe": [9, 11, 12], "buffer": 9, "knob": [9, 15], "choleskyopt": 9, "version": [9, 12, 18], "write_opposit": 9, "independ": 9, "write": 9, "mostli": 9, "connect": 9, "newli": 9, "bb": 10, "approx": 10, "expens": 10, "descent": [10, 17, 18], "abl": 10, "op": 10, "expos": 10, "apply_t": 10, "induc": [10, 14, 16, 18], "chol": 10, "anoth": [10, 12, 16], "fc": 10, "overwritten": 10, "pc_epsilon": 10, "jitter": 10, "add": [10, 16], "datatyp": 10, "boolean": [10, 12], "fall": [10, 16], "back": [10, 16], "atx": 10, "unknown": 10, "trsm": 10, "pc_util": 10, "init": 10, "weight_vec": 10, "reweight": 10, "inva": 10, "invat": 10, "invt": 10, "tx": 10, "invtt": 10, "k_mm": 10, "2nd": 10, "becom": [10, 16, 17], "usabl": 10, "lot": [10, 18], "pertain": 10, "variou": [10, 16, 17], "understand": 10, "sparse_tensor": 11, "indexptr": [11, 12], "index": [11, 12, 14, 20], "sparse_typ": [11, 12], "sparsetyp": 11, "csc": [11, 12], "pointer": 11, "pin_memori": 11, "convers": 11, "scipi": 11, "mathemat": 11, "separ": 11, "sparse_matmul": [11, 12], "arrai": [11, 14, 16, 17, 18], "row": [11, 12], "long": [11, 12, 15], "narrow_row": 11, "subset": 11, "after": [11, 16, 17], "sparse_square_norm": 11, "l2": 11, "limit": 11, "sparse_norm": 11, "show": [12, 13, 14, 18], "complementari": 12, "go": [12, 18, 21], "them": [12, 14, 16], "autodiff": 12, "tune": [12, 13, 15, 16], "matplotlib": [12, 14, 15, 16, 17, 18], "pyplot": [12, 14, 15, 16, 17, 18], "plt": [12, 14, 15, 16, 17, 18], "style": [12, 15, 16, 17, 18], "ggplot": [12, 15, 16, 17, 18], "sklearn": [12, 14, 16, 17, 18, 19], "np": [12, 14, 16, 17], "pykeop": [12, 14, 15, 16, 17, 18], "load": [12, 21], "preprocess": [12, 16], "california": 12, "hous": [12, 16], "learn_with_kernel": 12, "datas": 12, "fetch_california_h": [12, 16], "return_x_i": [12, 14, 16, 17, 19], "num_train": [12, 16], "num_test": [12, 16], "shuffle_idx": [12, 16], "arang": [12, 14, 16], "shuffl": [12, 14, 16, 17, 18], "train_idx": [12, 16], "test_idx": [12, 16], "xtrain": [12, 16], "ytrain": [12, 16], "xtest": [12, 16], "ytest": [12, 16], "convert": [12, 14, 15, 16, 17, 18], "pytorch": [12, 16, 20], "from_numpi": [12, 14, 16, 17, 18, 19], "z": [12, 14, 16, 17], "score": [12, 14, 16, 17], "train_mean": [12, 14, 16, 17], "keepdim": [12, 16], "train_std": [12, 14, 16, 17], "std": [12, 14, 16, 17], "def": [12, 14, 15, 16, 17, 18], "rmse": [12, 16], "reshap": [12, 14, 15, 16, 17, 18, 19], "ts_err": 12, "2f": [12, 14, 15, 17, 18], "later": 12, "section": 12, "varianc": 12, "basiclinearkernel": 12, "__init__": 12, "lengthscal": 12, "super": 12, "basic_linear": 12, "compat": 12, "scaled_x1": 12, "copy_": 12, "dim": [12, 14, 15, 17], "els": 12, "matmul": 12, "lengthscale_init": 12, "3538": 12, "0383": 12, "5058": 12, "1306": 12, "3159": 12, "9498": 12, "0581": 12, "4684": 12, "8994": 12, "7577": 12, "3122": 12, "1038": 12, "5039": 12, "5076": 12, "4032": 12, "8383": 12, "8545": 12, "4094": 12, "0497": 12, "4979": 12, "8344": 12, "5258": 12, "9362": 12, "7300": 12, "0740": 12, "1084": 12, "6743": 12, "2653": 12, "2448": 12, "6467": 12, "9": [12, 14, 15, 16, 17, 18], "8628": 12, "4857": 12, "12": [12, 14, 17, 18], "8557": 12, "36367178": 12, "11": [12, 14, 17, 18], "19508219": 12, "14": [12, 14, 17, 18], "19265079": 12, "17": [12, 17, 18], "19265032": 12, "19262338": 12, "24": [12, 17], "19262123": 12, "27": [12, 17, 18], "19261861": 12, "30": [12, 17, 18], "19261885": 12, "33": [12, 17], "19261789": 12, "39": [12, 14, 15, 16, 17, 18], "19261765": 12, "42": [12, 15, 17, 18], "19261956": 12, "45": [12, 15, 17], "19261932": 12, "48": [12, 17], "19261909": 12, "51": [12, 18], "19261813": 12, "55": [12, 15], "16": [12, 17, 18], "57": 12, "19261742": 12, "61": 12, "18": [12, 17], "63": [12, 17], "19261980": 12, "19": [12, 17], "66": 12, "73": 12, "19262052": 12, "discuss": 12, "similarli": 12, "essenti": 12, "clone": [12, 17], "simplifi": 12, "unit": [12, 16], "dot_prod_kernel": 12, "py": [12, 16], "distance_kernel": 12, "difflinearkernel": 12, "diff_linear": 12, "grad": 12, "requires_grad_": [12, 17], "notic": 12, "grad_fn": 12, "k_mat": 12, "7480": 12, "6149": 12, "2979": 12, "3070": 12, "1852": 12, "2437": 12, "8397": 12, "6248": 12, "1610": 12, "1940": 12, "6474": 12, "9644": 12, "4447": 12, "1742": 12, "0197": 12, "4735": 12, "4214": 12, "9773": 12, "3380": 12, "2361": 12, "8094": 12, "2183": 12, "5620": 12, "8260": 12, "8644": 12, "lt": [12, 15, 16, 18], "kernelmmfnfullbackward": 12, "gt": [12, 15, 16, 18], "autograd": 12, "7049": 12, "k_mmv": 12, "0198": 12, "6055": 12, "3654": 12, "6039": 12, "kernelmmvfnfullbackward": 12, "1758": 12, "6192": 12, "2544": 12, "06": 12, "20815659": 12, "19324374": 12, "19264197": 12, "19263649": 12, "19262934": 12, "21": [12, 17], "26": [12, 17], "19262004": 12, "34": [12, 16, 17], "38": [12, 17], "40": [12, 14, 17], "43": [12, 17], "46": [12, 15, 17], "49": [12, 17], "52": [12, 14], "19262099": 12, "54": [12, 14], "19262147": 12, "60": 12, "19262195": 12, "65": 12, "still": 12, "http": [12, 21], "www": 12, "io": 12, "api": [12, 14, 16, 20], "math": 12, "html": [12, 21], "syntax": 12, "again": 12, "symbol": 12, "documentatiaon": 12, "keopslinearkernel": 12, "my": 12, "vi": 12, "vj": 12, "pm": 12, "executor": 12, "compil": [12, 21], "2121": [12, 17], "1148": 12, "2435": 12, "9918": 12, "tilinggenredautogradbackward": 12, "9084": 12, "0124": 12, "8363": 12, "7706": 12, "requires_grad": 12, "27769995": 12, "19313025": 12, "19323778": 12, "19308257": 12, "82": 12, "19269753": 12, "98": [12, 15], "19266987": 12, "19262886": 12, "19262505": 12, "76": 12, "19260979": 12, "92": 12, "08": 12, "19261646": 12, "25": [12, 16, 17], "19263911": 12, "58": 12, "19264960": 12, "74": [12, 17, 18], "19265103": 12, "91": 12, "19268680": 12, "19269395": 12, "23": [12, 14, 17], "19270301": 12, "19275403": 12, "extrem": [12, 20], "coo": 12, "few": [12, 15, 18, 19], "detail": [12, 19, 20], "bdot": 12, "sparselinearkernel": 12, "sparse_linear": 12, "batch": 12, "transpose_csr": 12, "mul_": 12, "22": [12, 15, 17], "sp1": 12, "dense1": 12, "to_scipi": 12, "todens": 12, "sp2": 12, "dense2": 12, "cover": 13, "know": 13, "goe": 13, "notion": 13, "tutori": 13, "real": 13, "world": 13, "hyperopt": 13, "mnist": 13, "digit": [13, 14, 17], "integr": [14, 20], "scikit": [14, 16, 17, 20], "seamless": 14, "inlin": [14, 15, 16, 17, 18], "model_select": [14, 16, 17, 18], "metric": [14, 16], "panda": 14, "pd": 14, "alongsid": [14, 17, 21], "load_digit": [14, 17], "fig": [14, 15, 16, 17, 18], "subplot": [14, 15, 16, 17, 18], "matshow": 14, "cmap": [14, 17], "grai": [14, 17], "80": [14, 16, 17, 18], "x_train": [14, 17, 18], "x_test": [14, 17, 18], "y_train": [14, 17, 18], "y_test": [14, 17, 18], "train_test_split": [14, 17, 18], "test_siz": [14, 17, 18], "random_st": [14, 17, 18], "idea": [14, 17], "ordin": [14, 17], "ideal": [14, 17], "meaningless": [14, 17], "ey": [14, 15, 17, 18], "entir": 14, "feasibl": 14, "best": [14, 15, 16, 18], "great": 14, "gridsearchcv": 14, "paramat": 14, "fold": 14, "quit": [14, 17, 18], "160": 14, "mclass_loss": [14, 17], "argmax": [14, 15, 17], "mclass_scor": 14, "make_scor": 14, "greater_is_bett": 14, "explor": 14, "four": 14, "vari": 14, "almost": 14, "longer": [14, 18], "cours": 14, "easi": [14, 16, 18, 19], "overfit": [14, 17], "parameter_grid": 14, "mandatori": [14, 16, 18], "grid_search": 14, "cv": 14, "best_params_": 14, "sy": [14, 18], "78": 14, "wall": [14, 18], "held": 14, "flk": [14, 15, 16, 18], "best_estimator_": 14, "test_pr": [14, 15, 16], "train_pr": [14, 15, 16], "534": 14, "ms": [14, 18], "558": 14, "139": 14, "00": [14, 17], "were": 14, "success": 14, "coars": 14, "red": 14, "darker": 14, "blue": 14, "res_df": 14, "datafram": 14, "from_dict": 14, "cv_results_": 14, "item": [14, 16, 17], "mean_test_scor": 14, "plot_heatmap": 14, "xlabel": 14, "ylabel": 14, "piv": 14, "pivot_t": 14, "cm": 14, "get_cmap": 14, "coolwarm_r": 14, "c": 14, "pcolormesh": 14, "vmin": 14, "vmax": 14, "set_ytick": 14, "minor": 14, "set_xtick": 14, "set_xticklabel": 14, "set_yticklabel": 14, "set_xlabel": 14, "set_ylabel": 14, "ncol": [14, 17, 18], "figsiz": [14, 17, 18], "max": [14, 16], "set_titl": [14, 17, 18], "torchvis": 15, "mnist_train_dataset": 15, "root": 15, "totensor": 15, "mnist_test_dataset": 15, "mnist_tr_img_list": 15, "mnist_tr_label_list": 15, "len": 15, "data_point": 15, "append": [15, 17], "mnist_ts_img_list": 15, "mnist_ts_label_list": 15, "mnist_tr_x": 15, "vstack": 15, "mnist_ts_x": 15, "mnist_tr_i": 15, "mnist_ts_i": 15, "imshow": [15, 17], "28": [15, 17, 18], "imag": [15, 17], "axesimag": 15, "0x7f4ee3780130": 15, "wai": [15, 21], "classif_error": 15, "y_true": 15, "y_pred": 15, "err": 15, "flatten": 15, "adjust": 15, "toler": 15, "purpos": [15, 21], "strongli": 15, "11998333": 15, "02": [15, 17], "07140000": 15, "50": [15, 17, 18], "05766667": 15, "05121667": 15, "04776667": 15, "95": [15, 17], "04556667": 15, "04376667": 15, "93": 15, "04340000": 15, "04286667": 15, "04223333": 15, "toi": 16, "boston": 16, "demonstr": [16, 18], "offer": 16, "pose": 16, "506": 16, "goal": 16, "price": [16, 18], "crimin": 16, "rate": 16, "air": 16, "pollut": 16, "altern": 16, "done": 16, "util": 16, "found": [16, 18], "statist": 16, "leakag": 16, "spirit": 16, "featur": [16, 18, 20], "monitor": [16, 18], "fine": 16, "showcas": 16, "sizabl": 16, "portion": 16, "home": 16, "dropbox": 16, "unig": 16, "userwarn": 16, "fail": 16, "get_error_str": 16, "todo": 16, "thu": [16, 17], "gain": 16, "insight": 16, "properli": 16, "fallback": 16, "0x7f65871c45e0": 16, "quickli": 16, "3f": [16, 17], "527": 16, "578": 16, "plot": [16, 17], "hist_rang": 16, "hist": 16, "bin": 16, "legend": [16, 18], "loc": [16, 18], "plot_digit": 17, "set_axis_off": 17, "hyper": 17, "commonli": 17, "sometim": 17, "grid": 17, "search": [17, 20], "categori": 17, "With": 17, "resid": 17, "is_avail": [17, 21], "sigma_init": 17, "now": 17, "adam": 17, "hp": 17, "opt_hp": 17, "lr": 17, "And": 17, "tr_loss": 17, "tr_err": 17, "epoch": 17, "zero_grad": 17, "backward": 17, "40310": 17, "387": 17, "67": 17, "35137": 17, "203": 17, "24207": 17, "420": 17, "17153": 17, "834": 17, "12490": 17, "971": 17, "9343": 17, "7062": 17, "557": 17, "5359": 17, "402": 17, "4108": 17, "987": 17, "04": 17, "3210": 17, "683": 17, "90": [17, 18], "2569": 17, "709": 17, "547": 17, "1814": 17, "989": 17, "1606": 17, "087": 17, "1460": 17, "298": 17, "1353": 17, "231": 17, "1269": 17, "496": 17, "1199": 17, "922": 17, "1139": 17, "733": 17, "1088": 17, "957": 17, "1043": 17, "391": 17, "1002": 17, "747": 17, "966": 17, "935": 17, "513": 17, "907": 17, "745": 17, "883": 17, "216": 17, "861": 17, "607": 17, "842": 17, "661": 17, "826": 17, "113": 17, "811": 17, "653": 17, "798": 17, "939": 17, "31": 17, "787": 17, "643": 17, "777": 17, "481": 17, "768": 17, "217": 17, "759": 17, "674": 17, "35": [17, 18], "751": 17, "720": 17, "36": 17, "744": 17, "265": 17, "37": 17, "737": 17, "261": 17, "730": 17, "671": 17, "724": 17, "491": 17, "718": 17, "708": 17, "41": [17, 18], "713": 17, "325": 17, "335": 17, "703": 17, "722": 17, "44": 17, "699": 17, "472": 17, "695": 17, "691": 17, "47": 17, "688": 17, "580": 17, "685": 17, "445": 17, "682": 17, "ts_pred": 17, "83": 17, "3e": 17, "428e": 17, "3884": 17, "6252": 17, "7859": 17, "7036": 17, "6799": 17, "7698": 17, "7344": 17, "0071": 17, "5923": 17, "7421": 17, "7629": 17, "7525": 17, "6989": 17, "7232": 17, "8216": 17, "8830": 17, "6465": 17, "7994": 17, "7406": 17, "7082": 17, "8053": 17, "6552": 17, "7757": 17, "6979": 17, "7573": 17, "7242": 17, "6681": 17, "7780": 17, "7649": 17, "7010": 17, "7274": 17, "6608": 17, "7477": 17, "7604": 17, "8015": 17, "7581": 17, "6359": 17, "8348": 17, "7656": 17, "6553": 17, "6672": 17, "7252": 17, "7499": 17, "6721": 17, "6589": 17, "9603": 17, "7725": 17, "7143": 17, "7481": 17, "7307": 17, "7093": 17, "7251": 17, "7213": 17, "6326": 17, "6092": 17, "7600": 17, "7744": 17, "7885": 17, "6976": 17, "6838": 17, "half": [17, 18], "led": 17, "vs": 17, "bia": 17, "tend": 17, "rememb": 17, "seen": 17, "practic": 17, "synthet": 18, "verifi": 18, "consist": 18, "concentr": 18, "circl": 18, "bit": 18, "nois": 18, "trivial": 18, "draw": 18, "make_circl": 18, "n_sampl": 18, "10_000": 18, "122": 18, "scatter": 18, "marker": 18, "strictli": 18, "intern": 18, "sens": 18, "adequ": 18, "binary_loss": 18, "sign": 18, "disabl": 18, "flk_kernel": 18, "seri": 18, "empir": 18, "plan": 18, "logflk_opt": 18, "logflk_kernel": 18, "logloss": 18, "logflk": 18, "secon": 18, "laptop": 18, "clearli": 18, "necessarili": 18, "further": 18, "slowdown": 18, "5s": 18, "59": 18, "604": 18, "0x7f9f7d142b20": 18, "000000e": 18, "03": 18, "sub": 18, "4697": 18, "1544": 18, "3774": 18, "1551": 18, "3575": 18, "1534": 18, "3554": 18, "1530": 18, "0x7f9f7d150250": 18, "0x7f9f7d13eaf0": 18, "001": 18, "paid": 18, "varieti": 18, "vanilla": 18, "flk_pred": 18, "flk_err": 18, "logflk_pr": 18, "logflk_err": 18, "outer": 18, "middl": 18, "mispredict": 18, "perfect": 18, "clear": 18, "boundari": 18, "distinguish": 18, "plot_predict": 18, "color": 18, "cl": 18, "r": 18, "wrong": 18, "onc": 19, "setup": 19, "line": 19, "load_boston": 19, "trade": 20, "off": 20, "intens": 20, "capabl": 20, "scalabl": 20, "unlik": 20, "paper": 20, "github": [20, 21], "com": [20, 21], "falkonml": [20, 21], "built": 20, "research": 20, "pleas": 20, "cite": 20, "platform": 20, "prerequisit": 20, "develop": 20, "page": 20, "linux": 21, "window": 21, "tricki": 21, "portabl": 21, "mac": 21, "os": 21, "nvidia": 21, "toolkit": 21, "instruct": 21, "bind": 21, "link": 21, "pip": 21, "git": 21, "cython": 21, "everyth": 21, "edit": 21, "mode": 21, "directori": 21, "doc": 21}, "objects": {"": [[1, 0, 0, "-", "falkon"]], "falkon": [[0, 0, 0, "-", "center_selection"], [2, 0, 0, "-", "hopt"], [4, 0, 0, "-", "kernels"], [5, 0, 0, "-", "mmv_ops"], [6, 0, 0, "-", "models"], [9, 0, 0, "-", "ooc_ops"], [7, 0, 0, "-", "optim"], [8, 0, 0, "-", "options"], [10, 0, 0, "-", "preconditioner"], [11, 0, 0, "-", "sparse"]], "falkon.center_selection": [[0, 1, 1, "", "CenterSelector"], [0, 1, 1, "", "FixedSelector"], [0, 1, 1, "", "UniformSelector"]], "falkon.center_selection.CenterSelector": [[0, 2, 1, "", "select"], [0, 2, 1, "", "select_indices"]], "falkon.center_selection.FixedSelector": [[0, 2, 1, "", "select"], [0, 2, 1, "", "select_indices"]], "falkon.center_selection.UniformSelector": [[0, 2, 1, "", "select"], [0, 2, 1, "", "select_indices"]], "falkon.gsc_losses": [[1, 1, 1, "", "LogisticLoss"], [1, 1, 1, "", "Loss"], [1, 1, 1, "", "WeightedCrossEntropyLoss"]], "falkon.gsc_losses.LogisticLoss": [[1, 2, 1, "", "__call__"], [1, 2, 1, "", "ddf"], [1, 2, 1, "", "df"]], "falkon.gsc_losses.Loss": [[1, 2, 1, "", "__call__"], [1, 2, 1, "", "ddf"], [1, 2, 1, "", "df"], [1, 2, 1, "", "knmp_grad"], [1, 2, 1, "", "knmp_hess"]], "falkon.gsc_losses.WeightedCrossEntropyLoss": [[1, 2, 1, "", "__call__"], [1, 2, 1, "", "ddf"], [1, 2, 1, "", "df"]], "falkon.hopt.objectives": [[2, 1, 1, "", "CompReg"], [2, 1, 1, "", "GCV"], [2, 1, 1, "", "HoldOut"], [2, 1, 1, "", "LOOCV"], [2, 1, 1, "", "NystromCompReg"], [2, 1, 1, "", "SGPR"], [2, 1, 1, "", "StochasticNystromCompReg"]], "falkon.hopt.objectives.objectives": [[2, 1, 1, "", "HyperoptObjective"]], "falkon.kernels": [[4, 1, 1, "", "GaussianKernel"], [4, 1, 1, "", "LaplacianKernel"], [4, 1, 1, "", "LinearKernel"], [4, 1, 1, "", "MaternKernel"], [4, 1, 1, "", "PolynomialKernel"], [4, 1, 1, "", "SigmoidKernel"]], "falkon.kernels.GaussianKernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "mmv"]], "falkon.kernels.LaplacianKernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "mmv"]], "falkon.kernels.LinearKernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "mmv"]], "falkon.kernels.MaternKernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "mmv"]], "falkon.kernels.PolynomialKernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "mmv"]], "falkon.kernels.SigmoidKernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "mmv"]], "falkon.kernels.diff_kernel": [[4, 1, 1, "", "DiffKernel"]], "falkon.kernels.diff_kernel.DiffKernel": [[4, 2, 1, "", "compute_diff"], [4, 2, 1, "", "detach"], [4, 3, 1, "", "diff_params"]], "falkon.kernels.keops_helpers": [[4, 1, 1, "", "KeopsKernelMixin"]], "falkon.kernels.keops_helpers.KeopsKernelMixin": [[4, 2, 1, "", "keops_mmv"], [4, 2, 1, "", "keops_mmv_impl"]], "falkon.kernels.kernel": [[4, 1, 1, "", "Kernel"]], "falkon.kernels.kernel.Kernel": [[4, 2, 1, "", "__call__"], [4, 2, 1, "", "_decide_dmmv_impl"], [4, 2, 1, "", "_decide_mm_impl"], [4, 2, 1, "", "_decide_mmv_impl"], [4, 2, 1, "", "compute"], [4, 2, 1, "", "compute_sparse"], [4, 2, 1, "", "dmmv"], [4, 2, 1, "", "extra_mem"], [4, 2, 1, "", "mmv"]], "falkon.mmv_ops.fmm": [[5, 4, 1, "", "fmm"], [5, 4, 1, "", "sparse_mm_run_thread"]], "falkon.mmv_ops.fmmv": [[5, 4, 1, "", "fdmmv"], [5, 4, 1, "", "fmmv"], [5, 4, 1, "", "sparse_mmv_run_thread"]], "falkon.mmv_ops.fmmv_incore": [[5, 4, 1, "", "incore_fdmmv"], [5, 4, 1, "", "incore_fmmv"]], "falkon.mmv_ops.keops": [[5, 4, 1, "", "run_keops_mmv"]], "falkon.models": [[6, 1, 1, "", "Falkon"], [6, 1, 1, "", "InCoreFalkon"], [6, 1, 1, "", "LogisticFalkon"]], "falkon.models.Falkon": [[6, 2, 1, "", "fit"], [6, 2, 1, "", "get_params"], [6, 2, 1, "", "predict"], [6, 2, 1, "", "set_params"]], "falkon.models.InCoreFalkon": [[6, 2, 1, "", "fit"], [6, 2, 1, "", "get_params"], [6, 2, 1, "", "predict"], [6, 2, 1, "", "set_params"]], "falkon.models.LogisticFalkon": [[6, 2, 1, "", "fit"], [6, 2, 1, "", "get_params"], [6, 2, 1, "", "predict"], [6, 2, 1, "", "set_params"]], "falkon.ooc_ops": [[9, 4, 1, "", "gpu_cholesky"], [9, 4, 1, "", "gpu_lauum"]], "falkon.optim": [[7, 1, 1, "", "ConjugateGradient"], [7, 1, 1, "", "FalkonConjugateGradient"], [7, 1, 1, "", "Optimizer"]], "falkon.optim.ConjugateGradient": [[7, 2, 1, "", "solve"]], "falkon.options": [[8, 1, 1, "", "FalkonOptions"]], "falkon.preconditioner": [[10, 1, 1, "", "FalkonPreconditioner"], [10, 1, 1, "", "LogisticPreconditioner"]], "falkon.preconditioner.FalkonPreconditioner": [[10, 2, 1, "", "apply"], [10, 2, 1, "", "apply_t"], [10, 2, 1, "", "init"], [10, 2, 1, "", "invA"], [10, 2, 1, "", "invAt"], [10, 2, 1, "", "invT"], [10, 2, 1, "", "invTt"]], "falkon.preconditioner.LogisticPreconditioner": [[10, 2, 1, "", "apply"], [10, 2, 1, "", "apply_t"], [10, 2, 1, "", "init"], [10, 2, 1, "", "invA"], [10, 2, 1, "", "invAt"], [10, 2, 1, "", "invT"], [10, 2, 1, "", "invTt"]], "falkon.preconditioner.preconditioner": [[10, 1, 1, "", "Preconditioner"]], "falkon.sparse": [[11, 4, 1, "", "sparse_matmul"], [11, 4, 1, "", "sparse_norm"], [11, 4, 1, "", "sparse_square_norm"]], "falkon.sparse.sparse_tensor": [[11, 1, 1, "", "SparseTensor"], [11, 1, 1, "", "SparseType"]], "falkon.sparse.sparse_tensor.SparseTensor": [[11, 2, 1, "", "narrow_rows"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:property", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"]}, "titleterms": {"falkon": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 18, 20], "center_select": 0, "centerselector": 0, "uniformselector": 0, "fixedselector": 0, "gsc_loss": 1, "loss": 1, "logist": [1, 18], "weight": 1, "binari": 1, "cross": [1, 2], "entropi": 1, "hopt": 2, "object": 2, "nystrom": 2, "complex": 2, "regular": 2, "stochast": 2, "comput": 2, "gener": 2, "valid": 2, "hold": 2, "out": 2, "leav": 2, "One": 2, "sgpr": 2, "api": 3, "refer": [3, 20], "kernel": [4, 12], "diffkernel": 4, "keopskernelmixin": 4, "radial": 4, "gaussian": 4, "laplacian": 4, "matern": 4, "dot": 4, "product": 4, "polynomi": 4, "linear": 4, "sigmoid": 4, "mmv_op": 5, "run_keops_mmv": 5, "fmm": 5, "fmmv": 5, "fdmmv": 5, "incore_fmmv": 5, "incore_fdmmv": 5, "low": 5, "level": 5, "function": 5, "model": [6, 14, 16, 18], "logisticfalkon": 6, "incorefalkon": 6, "optim": [7, 14, 17], "conjug": 7, "gradient": 7, "method": 7, "conjugategradi": 7, "falkonconjugategradi": 7, "option": [8, 19], "falkonopt": 8, "ooc_op": 9, "gpu_choleski": 9, "gpu_lauum": 9, "precondition": 10, "choleski": 10, "falkonprecondition": 10, "logisticprecondition": 10, "spars": [11, 12], "sparsetensor": 11, "oper": 11, "implement": 12, "A": 12, "custom": 12, "setup": 12, "simpl": 12, "problem": 12, "test": [12, 14, 17, 18, 21], "basic": 12, "differenti": 12, "ad": 12, "keop": 12, "support": [12, 21], "data": [12, 14, 15, 16, 17, 18], "exampl": [13, 19], "hyperparamet": [14, 17], "tune": 14, "introduct": [14, 16, 18], "load": [14, 15, 16, 17, 18], "split": [14, 17, 18], "train": [14, 16, 17, 18], "set": [14, 17, 18], "preprocess": [14, 15, 17, 18], "search": 14, "paramet": 14, "evalu": [14, 16], "plot": [14, 18], "grid": 14, "result": 14, "mnist": 15, "classif": 15, "download": 15, "dataset": 15, "memori": 15, "run": 15, "regress": 16, "tutori": 16, "pre": 16, "process": 16, "creat": 16, "perform": 16, "automat": 17, "introduc": 18, "defin": 18, "both": 18, "predict": 18, "get": 19, "start": 19, "pass": 19, "more": 19, "content": 20, "indic": 20, "tabl": 20, "instal": 21, "platform": 21, "prerequisit": 21, "pytorch": 21, "cuda": 21, "intel": 21, "mkl": 21, "develop": 21}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 56}})